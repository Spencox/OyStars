
const sampleResults = {
  "businesses": [
    {
      "id": "VaO-VW3e1kARkU9bP1E7Fw",
      "alias": "felixs-restaurant-and-oyster-bar-new-orleans",
      "name": "Felix's Restaurant & Oyster Bar",
      "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/B6DCtVG0FesvBr0j5FoWeA/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/felixs-restaurant-and-oyster-bar-new-orleans?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 4614,
      "categories": [
        {
          "alias": "seafood",
          "title": "Seafood"
        },
        {
          "alias": "cajun",
          "title": "Cajun/Creole"
        }
      ],
      "rating": 4,
      "coordinates": {
        "latitude": 29.9546804305772,
        "longitude": -90.0689453974164
      },
      "transactions": [
        "delivery"
      ],
      "price": "$$",
      "location": {
        "address1": "739 Iberville St",
        "address2": "",
        "address3": "",
        "city": "New Orleans",
        "zip_code": "70130",
        "country": "US",
        "state": "LA",
        "display_address": [
          "739 Iberville St",
          "New Orleans, LA 70130"
        ]
      },
      "phone": "+15045224440",
      "display_phone": "(504) 522-4440",
      "distance": 1436.7920392498686
    },
    {
      "id": "JvawJ9bSr22xn4R9oLvl_w",
      "alias": "desire-oyster-bar-new-orleans-2",
      "name": "Desire Oyster Bar",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/cUN7vQBtNtVEWgkXDcR48g/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/desire-oyster-bar-new-orleans-2?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 1223,
      "categories": [
        {
          "alias": "seafood",
          "title": "Seafood"
        },
        {
          "alias": "cajun",
          "title": "Cajun/Creole"
        },
        {
          "alias": "southern",
          "title": "Southern"
        }
      ],
      "rating": 4,
      "coordinates": {
        "latitude": 29.9555269924731,
        "longitude": -90.0681538392868
      },
      "transactions": [],
      "price": "$$",
      "location": {
        "address1": "300 Bourbon St",
        "address2": "",
        "address3": "",
        "city": "New Orleans",
        "zip_code": "70130",
        "country": "US",
        "state": "LA",
        "display_address": [
          "300 Bourbon St",
          "New Orleans, LA 70130"
        ]
      },
      "phone": "+15045532281",
      "display_phone": "(504) 553-2281",
      "distance": 1505.815146145921
    },
    {
      "id": "swVdc9piXvG0AXwL-F0GfQ",
      "alias": "gallier-restaurant-and-oyster-bar-new-orleans",
      "name": "Gallier Restaurant & Oyster Bar",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/IUq5PVNVXb7LjPzhrbw0KQ/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/gallier-restaurant-and-oyster-bar-new-orleans?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 1313,
      "categories": [
        {
          "alias": "seafood",
          "title": "Seafood"
        },
        {
          "alias": "cajun",
          "title": "Cajun/Creole"
        },
        {
          "alias": "southern",
          "title": "Southern"
        }
      ],
      "rating": 4.5,
      "coordinates": {
        "latitude": 29.9533,
        "longitude": -90.07077
      },
      "transactions": [
        "delivery"
      ],
      "price": "$$",
      "location": {
        "address1": "129 Carondelet St",
        "address2": null,
        "address3": "",
        "city": "New Orleans",
        "zip_code": "70112",
        "country": "US",
        "state": "LA",
        "display_address": [
          "129 Carondelet St",
          "New Orleans, LA 70112"
        ]
      },
      "phone": "+15042675672",
      "display_phone": "(504) 267-5672",
      "distance": 1303.8020218542938
    },
    {
      "id": "EME5hqQLjBD7e2cLryupbA",
      "alias": "mr-eds-oyster-bar-bienville-new-orleans-2",
      "name": "Mr Ed's Oyster Bar - Bienville",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/zbjKOhIzHG5UCha15cjuTg/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/mr-eds-oyster-bar-bienville-new-orleans-2?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 1726,
      "categories": [
        {
          "alias": "cajun",
          "title": "Cajun/Creole"
        },
        {
          "alias": "seafood",
          "title": "Seafood"
        }
      ],
      "rating": 4.5,
      "coordinates": {
        "latitude": 29.9537198203863,
        "longitude": -90.0659187477944
      },
      "transactions": [
        "delivery"
      ],
      "price": "$$",
      "location": {
        "address1": "512 Bienville St",
        "address2": "",
        "address3": "",
        "city": "New Orleans",
        "zip_code": "70130",
        "country": "US",
        "state": "LA",
        "display_address": [
          "512 Bienville St",
          "New Orleans, LA 70130"
        ]
      },
      "phone": "+15043094848",
      "display_phone": "(504) 309-4848",
      "distance": 1730.9173721802133
    },
    {
      "id": "_ab50qdWOk0DdB6XOrBitw",
      "alias": "acme-oyster-house-new-orleans",
      "name": "Acme Oyster House",
      "image_url": "https://s3-media4.fl.yelpcdn.com/bphoto/jZdCH37gmOelacqaQE97Dg/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/acme-oyster-house-new-orleans?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 8405,
      "categories": [
        {
          "alias": "seafood",
          "title": "Seafood"
        },
        {
          "alias": "cajun",
          "title": "Cajun/Creole"
        },
        {
          "alias": "raw_food",
          "title": "Live/Raw Food"
        }
      ],
      "rating": 4,
      "coordinates": {
        "latitude": 29.95431,
        "longitude": -90.06894
      },
      "transactions": [
        "delivery"
      ],
      "price": "$$",
      "location": {
        "address1": "724 Iberville St",
        "address2": null,
        "address3": "",
        "city": "New Orleans",
        "zip_code": "70130",
        "country": "US",
        "state": "LA",
        "display_address": [
          "724 Iberville St",
          "New Orleans, LA 70130"
        ]
      },
      "phone": "+15045225973",
      "display_phone": "(504) 522-5973",
      "distance": 1440.5331397808877
    },
    {
      "id": "VQcCL9PiNL_wkGf-uF3fjg",
      "alias": "royal-house-new-orleans",
      "name": "Royal House",
      "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/41QZ_g7_nyNN7Jny8gRpXw/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/royal-house-new-orleans?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 5605,
      "categories": [
        {
          "alias": "cajun",
          "title": "Cajun/Creole"
        },
        {
          "alias": "seafood",
          "title": "Seafood"
        },
        {
          "alias": "sandwiches",
          "title": "Sandwiches"
        }
      ],
      "rating": 4,
      "coordinates": {
        "latitude": 29.956407,
        "longitude": -90.066412
      },
      "transactions": [
        "delivery"
      ],
      "price": "$$",
      "location": {
        "address1": "441 Royal St",
        "address2": "",
        "address3": "",
        "city": "New Orleans",
        "zip_code": "70130",
        "country": "US",
        "state": "LA",
        "display_address": [
          "441 Royal St",
          "New Orleans, LA 70130"
        ]
      },
      "phone": "+15045282601",
      "display_phone": "(504) 528-2601",
      "distance": 1676.4673050348206
    },
    {
      "id": "V9VLhHdSFpFi4yXFqVcVEA",
      "alias": "pêche-new-orleans",
      "name": "Pêche",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/iWEpTkk9OBEk3o6mjPo7vQ/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/p%C3%AAche-new-orleans?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 2304,
      "categories": [
        {
          "alias": "seafood",
          "title": "Seafood"
        }
      ],
      "rating": 4.5,
      "coordinates": {
        "latitude": 29.94506,
        "longitude": -90.06901
      },
      "transactions": [],
      "price": "$$$",
      "location": {
        "address1": "800 Magazine St",
        "address2": "",
        "address3": null,
        "city": "New Orleans",
        "zip_code": "70130",
        "country": "US",
        "state": "LA",
        "display_address": [
          "800 Magazine St",
          "New Orleans, LA 70130"
        ]
      },
      "phone": "+15045221744",
      "display_phone": "(504) 522-1744",
      "distance": 1869.439468761801
    },
    {
      "id": "SJIQFKTW6uUsOo29w9IHxw",
      "alias": "mambos-new-orleans",
      "name": "Mambo's",
      "image_url": "https://s3-media4.fl.yelpcdn.com/bphoto/tarz6Y_fjU42sDk_SwBUPA/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/mambos-new-orleans?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 2141,
      "categories": [
        {
          "alias": "cajun",
          "title": "Cajun/Creole"
        },
        {
          "alias": "seafood",
          "title": "Seafood"
        },
        {
          "alias": "soulfood",
          "title": "Soul Food"
        }
      ],
      "rating": 4,
      "coordinates": {
        "latitude": 29.95668,
        "longitude": -90.06772
      },
      "transactions": [
        "delivery",
        "pickup"
      ],
      "price": "$$",
      "location": {
        "address1": "411 Bourbon St",
        "address2": "",
        "address3": null,
        "city": "New Orleans",
        "zip_code": "70130",
        "country": "US",
        "state": "LA",
        "display_address": [
          "411 Bourbon St",
          "New Orleans, LA 70130"
        ]
      },
      "phone": "+15044073717",
      "display_phone": "(504) 407-3717",
      "distance": 1554.3026293264988
    },
    {
      "id": "Ppy-UN5RptIog4AvNnAM-g",
      "alias": "acme-oyster-house-metairie",
      "name": "Acme Oyster House",
      "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/e6TYYmZUkpC_A8NMUCA0nQ/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/acme-oyster-house-metairie?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 959,
      "categories": [
        {
          "alias": "seafood",
          "title": "Seafood"
        }
      ],
      "rating": 4,
      "coordinates": {
        "latitude": 30.002567,
        "longitude": -90.1530120372772
      },
      "transactions": [
        "delivery"
      ],
      "price": "$$",
      "location": {
        "address1": "3000 Veterans Blvd",
        "address2": "",
        "address3": "",
        "city": "Metairie",
        "zip_code": "70002",
        "country": "US",
        "state": "LA",
        "display_address": [
          "3000 Veterans Blvd",
          "Metairie, LA 70002"
        ]
      },
      "phone": "+15043094056",
      "display_phone": "(504) 309-4056",
      "distance": 8437.555236700942
    },
    {
      "id": "ac1AeYqs8Z4_e2X5M3if2A",
      "alias": "oceana-grill-new-orleans-4",
      "name": "Oceana Grill",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/xW9nO4DC_N-nYO9_jq9qdg/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/oceana-grill-new-orleans-4?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 8903,
      "categories": [
        {
          "alias": "cajun",
          "title": "Cajun/Creole"
        },
        {
          "alias": "seafood",
          "title": "Seafood"
        },
        {
          "alias": "breakfast_brunch",
          "title": "Breakfast & Brunch"
        }
      ],
      "rating": 4,
      "coordinates": {
        "latitude": 29.956231,
        "longitude": -90.067563
      },
      "transactions": [
        "delivery",
        "pickup"
      ],
      "price": "$$",
      "location": {
        "address1": "739 Conti St",
        "address2": "",
        "address3": null,
        "city": "New Orleans",
        "zip_code": "70130",
        "country": "US",
        "state": "LA",
        "display_address": [
          "739 Conti St",
          "New Orleans, LA 70130"
        ]
      },
      "phone": "+15045256002",
      "display_phone": "(504) 525-6002",
      "distance": 1561.540615104902
    },
    {
      "id": "-VlBFlHwX-Pt6Xyzs9roGw",
      "alias": "superior-seafood-and-oyster-bar-new-orleans",
      "name": "Superior Seafood & Oyster Bar",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/u652YR9BtC3ik9KZp83Qqw/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/superior-seafood-and-oyster-bar-new-orleans?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 1915,
      "categories": [
        {
          "alias": "seafood",
          "title": "Seafood"
        },
        {
          "alias": "cajun",
          "title": "Cajun/Creole"
        },
        {
          "alias": "brasseries",
          "title": "Brasseries"
        }
      ],
      "rating": 4,
      "coordinates": {
        "latitude": 29.92623550149,
        "longitude": -90.1016806155892
      },
      "transactions": [
        "delivery",
        "pickup"
      ],
      "price": "$$",
      "location": {
        "address1": "4338 St Charles Ave",
        "address2": "",
        "address3": "",
        "city": "New Orleans",
        "zip_code": "70115",
        "country": "US",
        "state": "LA",
        "display_address": [
          "4338 St Charles Ave",
          "New Orleans, LA 70115"
        ]
      },
      "phone": "+15042933474",
      "display_phone": "(504) 293-3474",
      "distance": 3740.8590188250932
    },
    {
      "id": "GBTPC53ZrG1ZBY3DT8Mbcw",
      "alias": "luke-new-orleans-3",
      "name": "Luke",
      "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/tCq_ObNeMTevPPXhiFfDGA/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/luke-new-orleans-3?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 5028,
      "categories": [
        {
          "alias": "french",
          "title": "French"
        },
        {
          "alias": "german",
          "title": "German"
        },
        {
          "alias": "cajun",
          "title": "Cajun/Creole"
        }
      ],
      "rating": 4,
      "coordinates": {
        "latitude": 29.9507416316034,
        "longitude": -90.0704155423279
      },
      "transactions": [
        "delivery"
      ],
      "price": "$$$",
      "location": {
        "address1": "333 Saint Charles Ave",
        "address2": "",
        "address3": "",
        "city": "New Orleans",
        "zip_code": "70130",
        "country": "US",
        "state": "LA",
        "display_address": [
          "333 Saint Charles Ave",
          "New Orleans, LA 70130"
        ]
      },
      "phone": "+15043782840",
      "display_phone": "(504) 378-2840",
      "distance": 1417.2049185378567
    },
    {
      "id": "S2Ho8yLxhKAa26pBAm6rxA",
      "alias": "creole-house-restaurant-and-oyster-bar-new-orleans",
      "name": "Creole House Restaurant & Oyster Bar",
      "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/0U07KJ1SssJwewLS8erDBw/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/creole-house-restaurant-and-oyster-bar-new-orleans?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 2292,
      "categories": [
        {
          "alias": "cajun",
          "title": "Cajun/Creole"
        },
        {
          "alias": "seafood",
          "title": "Seafood"
        },
        {
          "alias": "breakfast_brunch",
          "title": "Breakfast & Brunch"
        }
      ],
      "rating": 4,
      "coordinates": {
        "latitude": 29.95223,
        "longitude": -90.06715
      },
      "transactions": [
        "delivery"
      ],
      "price": "$$",
      "location": {
        "address1": "509 Canal St",
        "address2": null,
        "address3": "",
        "city": "New Orleans",
        "zip_code": "70130",
        "country": "US",
        "state": "LA",
        "display_address": [
          "509 Canal St",
          "New Orleans, LA 70130"
        ]
      },
      "phone": "+15043232109",
      "display_phone": "(504) 323-2109",
      "distance": 1659.7156016438933
    },
    {
      "id": "Ztbcpzx9sQdNQnKx8yghTA",
      "alias": "sidecar-nola-patio-and-oyster-bar-new-orleans",
      "name": "Sidecar Nola Patio & Oyster Bar",
      "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/r4PELykxPTwmHMZFe7mDqg/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/sidecar-nola-patio-and-oyster-bar-new-orleans?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 136,
      "categories": [
        {
          "alias": "cocktailbars",
          "title": "Cocktail Bars"
        },
        {
          "alias": "newamerican",
          "title": "New American"
        },
        {
          "alias": "venues",
          "title": "Venues & Event Spaces"
        }
      ],
      "rating": 4.5,
      "coordinates": {
        "latitude": 29.94054,
        "longitude": -90.069184
      },
      "transactions": [],
      "price": "$$",
      "location": {
        "address1": "1114 Constance St",
        "address2": null,
        "address3": "",
        "city": "New Orleans",
        "zip_code": "70130",
        "country": "US",
        "state": "LA",
        "display_address": [
          "1114 Constance St",
          "New Orleans, LA 70130"
        ]
      },
      "phone": "+15043815079",
      "display_phone": "(504) 381-5079",
      "distance": 2227.7082718625334
    },
    {
      "id": "26jYcdFR5oLqKDKpTH0JIQ",
      "alias": "dragos-seafood-restaurant-metairie",
      "name": "Drago's Seafood Restaurant",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/rRRRKtzkgC_x3vxrspWZxw/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/dragos-seafood-restaurant-metairie?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 1415,
      "categories": [
        {
          "alias": "seafood",
          "title": "Seafood"
        },
        {
          "alias": "desserts",
          "title": "Desserts"
        },
        {
          "alias": "salad",
          "title": "Salad"
        }
      ],
      "rating": 4,
      "coordinates": {
        "latitude": 30.00903,
        "longitude": -90.16082
      },
      "transactions": [
        "delivery"
      ],
      "price": "$$",
      "location": {
        "address1": "3232 N Arnoult Rd",
        "address2": "",
        "address3": "",
        "city": "Metairie",
        "zip_code": "70002",
        "country": "US",
        "state": "LA",
        "display_address": [
          "3232 N Arnoult Rd",
          "Metairie, LA 70002"
        ]
      },
      "phone": "+15048889254",
      "display_phone": "(504) 888-9254",
      "distance": 9489.625810425208
    },
    {
      "id": "NRfPp3teG31PgEJuIipbSw",
      "alias": "p-and-j-oyster-co-new-orleans",
      "name": "P & J Oyster Co.",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/Fi1m45hy2W7e67PynbFuZQ/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/p-and-j-oyster-co-new-orleans?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 13,
      "categories": [
        {
          "alias": "seafoodmarkets",
          "title": "Seafood Markets"
        }
      ],
      "rating": 4.5,
      "coordinates": {
        "latitude": 29.95962,
        "longitude": -90.06882
      },
      "transactions": [],
      "price": "$",
      "location": {
        "address1": "1039 Toulouse St",
        "address2": "",
        "address3": "",
        "city": "New Orleans",
        "zip_code": "70112",
        "country": "US",
        "state": "LA",
        "display_address": [
          "1039 Toulouse St",
          "New Orleans, LA 70112"
        ]
      },
      "phone": "+15045232651",
      "display_phone": "(504) 523-2651",
      "distance": 1492.7515079146922
    },
    {
      "id": "DcBLYSvOuWcNReolRVr12A",
      "alias": "dragos-seafood-restaurant-new-orleans",
      "name": "Drago's Seafood Restaurant",
      "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/hPAQCCwvY28mZfU_VoNSWA/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/dragos-seafood-restaurant-new-orleans?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 3709,
      "categories": [
        {
          "alias": "seafood",
          "title": "Seafood"
        }
      ],
      "rating": 3.5,
      "coordinates": {
        "latitude": 29.9475628171886,
        "longitude": -90.0633108615875
      },
      "transactions": [
        "delivery"
      ],
      "price": "$$",
      "location": {
        "address1": "2 Poydras St",
        "address2": "",
        "address3": "Hilton New Orleans Riverside",
        "city": "New Orleans",
        "zip_code": "70140",
        "country": "US",
        "state": "LA",
        "display_address": [
          "2 Poydras St",
          "Hilton New Orleans Riverside",
          "New Orleans, LA 70140"
        ]
      },
      "phone": "+15045843911",
      "display_phone": "(504) 584-3911",
      "distance": 2187.1096323076645
    },
    {
      "id": "7ybQY-BKNvlzEEjIQOkA4g",
      "alias": "seaworthy-new-orleans",
      "name": "Seaworthy ",
      "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/dSiLRAw9Vpg-Qh11tuCqnQ/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/seaworthy-new-orleans?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 510,
      "categories": [
        {
          "alias": "cocktailbars",
          "title": "Cocktail Bars"
        },
        {
          "alias": "seafood",
          "title": "Seafood"
        }
      ],
      "rating": 4,
      "coordinates": {
        "latitude": 29.94787,
        "longitude": -90.07217
      },
      "transactions": [
        "delivery",
        "pickup"
      ],
      "price": "$$",
      "location": {
        "address1": "630 Carondelet St",
        "address2": null,
        "address3": "",
        "city": "New Orleans",
        "zip_code": "70130",
        "country": "US",
        "state": "LA",
        "display_address": [
          "630 Carondelet St",
          "New Orleans, LA 70130"
        ]
      },
      "phone": "+15049303071",
      "display_phone": "(504) 930-3071",
      "distance": 1446.5568767986354
    },
    {
      "id": "6a4gLLFSgr-Q6CZXDLzBGQ",
      "alias": "cochon-new-orleans-3",
      "name": "Cochon",
      "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/Z30o0oDp3L4p6MfeeGzxMg/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/cochon-new-orleans-3?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 4895,
      "categories": [
        {
          "alias": "cajun",
          "title": "Cajun/Creole"
        },
        {
          "alias": "seafood",
          "title": "Seafood"
        }
      ],
      "rating": 4,
      "coordinates": {
        "latitude": 29.94226,
        "longitude": -90.06713
      },
      "transactions": [
        "delivery"
      ],
      "price": "$$",
      "location": {
        "address1": "930 Tchoupitoulas St",
        "address2": "",
        "address3": null,
        "city": "New Orleans",
        "zip_code": "70130",
        "country": "US",
        "state": "LA",
        "display_address": [
          "930 Tchoupitoulas St",
          "New Orleans, LA 70130"
        ]
      },
      "phone": "+15045882123",
      "display_phone": "(504) 588-2123",
      "distance": 2209.9842246665253
    },
    {
      "id": "FQJ4ph8e1SMz5YWsdH2m8Q",
      "alias": "mr-eds-oyster-bar-st-charles-ave-new-orleans",
      "name": "Mr. Ed's Oyster Bar - St Charles Ave",
      "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/EgP5a_XnhrEoAli_dpM_Mw/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/mr-eds-oyster-bar-st-charles-ave-new-orleans?adjust_creative=GvILGFxL2OCuepCm0neQ1A&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=GvILGFxL2OCuepCm0neQ1A",
      "review_count": 409,
      "categories": [
        {
          "alias": "seafood",
          "title": "Seafood"
        },
        {
          "alias": "steak",
          "title": "Steakhouses"
        },
        {
          "alias": "bars",
          "title": "Bars"
        }
      ],
      "rating": 4,
      "coordinates": {
        "latitude": 29.94013,
        "longitude": -90.07517
      },
      "transactions": [
        "delivery"
      ],
      "price": "$$",
      "location": {
        "address1": "1327 St Charles Ave",
        "address2": null,
        "address3": "",
        "city": "New Orleans",
        "zip_code": "70130",
        "country": "US",
        "state": "LA",
        "display_address": [
          "1327 St Charles Ave",
          "New Orleans, LA 70130"
        ]
      },
      "phone": "+15042670169",
      "display_phone": "(504) 267-0169",
      "distance": 1955.0258916800688
    }
  ],
  "total": 657,
  "region": {
    "center": {
      "longitude": -90.08377075195312,
      "latitude": 29.956084336405493
    }
  }
}
const sampleMarkers =
[{"name":"Gallier Restaurant & Oyster Bar","rating":4.5,"latitude":29.9533,"longitude":-90.07077,"distance":0.8102680346774834},{"name":"Mr Ed's Oyster Bar - Bienville","rating":4.5,"latitude":29.9537198203863,"longitude":-90.0659187477944,"distance":1.075593533762825},{"name":"Pêche","rating":4.5,"latitude":29.94506,"longitude":-90.06901,"distance":1.1613427582915772},{"name":"Sidecar Nola Patio & Oyster Bar","rating":4.5,"latitude":29.94054,"longitude":-90.069184,"distance":1.3844150163047801},{"name":"P & J Oyster Co.","rating":4.5,"latitude":29.95962,"longitude":-90.06882,"distance":0.9277071900103396}]

// catch variable from previous page
document.addEventListener("DOMContentLoaded", () => {
  // Get the mainVariable from the main page
  const searchCity = window.parent.mainSearchCity;
  console.log(searchCity);

});

// DOM variables
const searchFormInput2El = $('form[id="search-form-2"]');
const oysterBarShowEl = $('.card .box.custom-box p');
const oysterRatingShowEl = $('.card .box.custom-box span');

// global variables
let oysterBars = [];
let barGeoMarkers = [];
let mapCenter = [];
let currentMarkers = [];

// helper function to convert meters to miles
function meterToMiles(meters) {
    return meters / 1609.344;
}

// helper function to encode
function parameterize(inputString) {
    return encodeURIComponent(inputString);
} 

function init() {
    const mainSearchInput = localStorage.getItem("Main Search");
    if(mainSearchInput){
      search(mainSearchInput);
    }
}

// search bar input 
const searchBarInput = function (event) {
  if(oysterBars) {
    oysterBars = [];
  }
  event.preventDefault();  
  const cityName = searchFormInput2El.find('input[type="search"]').val().trim();
  search(cityName);
};

// performs the calls to the API's and waits for responses before next call
function search(cityName) {
  if (cityName) {
    getOysterBars(cityName)
      .then(() =>{
        localStorage.setItem("Latest Search" , JSON.stringify(oysterBars));
        localStorage.setItem("Map Center" , mapCenter);
        removeMarkers();
        display5Recs(oysterBars, oysterBarShowEl, oysterRatingShowEl);
        setMapMarkers();
      })
      .catch(function (error) {
        console.log("Error fetching geolocation data:", error);
      });
  } else {
    console.log("Could not find city");
  }
}

function getOysterBars(cityName) {
  // API pulls
  const term = parameterize("Oyster Bar");
  const radius = parameterize(16000);
  const city = parameterize(cityName);

  const apiKey = "kT1vrdR38ReeEi5Fp3V6GoutMCPJmG6g_0MVvbPu0iiZxQKUVVTx1YrKZgeGpfyZcjxw8hOWbyR_HVsP_dneULilLHrIIDVXBY0hst-XJhAWEAZwir1oUAbSico5ZXYx"

  const CORSanywhere = 'https://cors-anywhere.herokuapp.com/'
  const searchUrl = `${CORSanywhere}https://api.yelp.com/v3/businesses/search?location=${city}&term=${term}&radius=${radius}&limit=20`;
  
  // reset center of map
  mapCenter = [];  

    // api header and method
  const options = {
    method: 'GET',
    headers: {
        accept: '*/*',
        Authorization: `Bearer ${apiKey}`,
        'Access-Control-Allow-Origin': '*'
    }
  };

  // api call to businesses  
  return fetch(searchUrl, options)
    .then(response => response.json())
    .then(data => {
        buildResults(data);
        mapCenter = [data.region.center.longitude, data.region.center.latitude];
        updateMap();
        display5Recs(oysterBars, oysterBarShowEl, oysterRatingShowEl);
    })
    .catch(err => console.error(err));
}

//helper function to sort array of returned business by rating
function sortRatingsDec(businessObjArr) {
    return businessObjArr.sort((a, b) => {
        return b.rating - a.rating
    });
}

function buildResults(results) {
    barGeoMarkers = [];
    const highlyRated = sortRatingsDec(results.businesses);
    // take top 5 
    const displayRating = highlyRated.slice(0, 5);
    // build objects for each
    displayRating.forEach(business => {
        const oystarRec =  {
            name: business.name,
            rating: business.rating,
            latitude: business.coordinates.latitude,
            longitude: business.coordinates.longitude,
            distance: meterToMiles(Math.round(business.distance))
        }
        oysterBars.push(oystarRec);
    }); 
}

// for testing
//buildResults(sampleResults);
//display5Recs(oysterBars, oysterBarShowEl, oysterRatingShowEl);
//setMapMarkers();

// set map markers for display
function setMapMarkers() {
  const storedGeoData = JSON.parse(localStorage.getItem("Latest Search"));
  storedGeoData.forEach(bar =>{
    const lat = bar.latitude;
    const lon = bar.longitude;
    barGeoMarkers.push([lon, lat]);
  })
  makeMarkers(barGeoMarkers);
}

// display OyStar's recommendations
function display5Recs(oysterBarsArr, names, ratings) {
    names.each(function(index) {
        const oysterBarEl = $(this);
        const name = oysterBarsArr[index].name;
        oysterBarEl.text(name);
    });
    ratings.each(function(index) {
        const oysterRatingEl = $(this);
        const rating = oysterBarsArr[index].rating;
        oysterRatingEl.text(rating);
    });
}

// secondary search page
$(document).ready(function () {
  searchFormInput2El.on('submit', function (event) {
    event.preventDefault();
    console.log(event);
    searchBarInput(event);
  });
});

init();

// ---------------- map box API implementation --------------------------//

// Include the Mapbox GL JavaScript library
// var script = document.createElement('script');
// script.src = 'https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.js';
// document.head.appendChild(script);

var map;

// Wait for the Mapbox GL library to load
  mapboxgl.accessToken = 'pk.eyJ1Ijoic3BlbmNveCIsImEiOiJjbG9oN3lrZ2cxNTQwMmtvMXhobzNjNGtkIn0.EJ4_kGTLF2H6xpOh2jV9TA';
  
  // Initialize the map once the library is loaded
    map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/streets-v11',
    center: [-97.7431, 30.2672], // Default center (Austin, TX coordinates)
    zoom: 10 // Adjust the zoom level as needed
  });

// Function to create markers
function makeMarkers(markerArr) {
  // Create new markers based on updatedMarkerArr
  markerArr.forEach(marker => {
    const m = new mapboxgl.Marker()
      .setLngLat(marker)
      .addTo(map);
      currentMarkers.push(m);
  });
}

// re-centers map
function updateMap(){
  if (map) {
    map.setCenter(mapCenter);
    removeMarkers();
  } else {
    console.error('Map is not yet initialized.');
  }
}

// removes existing markers
function removeMarkers() {
  if (currentMarkers.length > 0) {
    currentMarkers.forEach(marker => {
      console.log(marker);
      marker.remove();
    });
    currentMarkers = []; // Clear the currentMarkers array
  }
}
